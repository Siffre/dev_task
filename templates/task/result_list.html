{% extends "base.html" %}
{% block result_list %}
    active
{% endblock %}
{% block content %}
    <div class="row">
        <div class="col-md-12">
    <!-- Horizontal Form -->
            {% csrf_token %}
            <div class="box box-info">
                <div class="box-header with-border">
                    <h3 class="box-title">任务结果</h3>
                </div>
                <div class="box-body">
                    <table id="result_table" class="table table-bordered table-striped">
                      <thead>
                        <tr>
                            <th>任务类型</th>
                            <th>任务状态</th>
                            <th>任务指令</th>
                            <th>完成时间</th>
                            <th>任务结果</th>
                            <th>任务异常</th>
                        </tr>
                      </thead>
                        <tbody>
                        {% for result in result_info %}
                            <tr class="even gradeA">
                                <td>{{ result.task_name }}</td>
                                <td>{{ result.status }}</td>
                                <td>{{ result.task_kwargs }}</td>
                                <td>{{ result.date_done|date:"Y-m-d H:i:s" }}</td>
                                {% if  result.result %}
                                    <td><div style="overflow-y:scroll;width: 200px;height: 100px;">{{ result.result }}</div></td>
                                {% else %}
                                    <td>{{ result.result }}</td>
                                {% endif %}
                                {% if  result.traceback %}
                                    <td><div style="overflow-y:scroll;width: 200px;height: 100px;">{{ result.traceback }}</div></td>
                                {% else %}
                                    <td>{{ result.tracebackt }}</td>
                                {% endif %}
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
{% block scripts-files %}
<script>
  $(function () {
    $('#result_table').DataTable({
      "paging": true,
      "lengthChange": true,
      "searching": true,
      "ordering": false,
      "info": true,
      "autoWidth": true
    });
  });
</script>
{% endblock %}